<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns:b='http://192.168.0.116/' xml:lang="en">
	<head>
		<title>xpath_forIE</title>
		<script type="text/javascript">
            function createDocument() {
                if ( typeof arguments.callee.activeXString != "string") {
                    var versions = ["MSXML2.DOMDocument.6.0", "MSXML2.DOMDocument.3.0", "MSXML2.DOMDocument"];

                    for (var i = 0, len = versions.length; i < len; i++) {
                        try {
                            var xmldom = new ActiveXObject(versions[i]);
                            arguments.callee.activeXString = versions[i];
                            return xmldom;
                        } catch (ex) {
                            //skip
                        }
                    }
                }

                return new ActiveXObject(arguments.callee.activeXString);
            }
		</script>
	</head>

	<body>
		<script type="text/javascript">
            /*
             * ie对命名空间的支持
             */
            var xmldom2 = createDocument();
            xmldom2.async = false;
            xmldom2.load("books.xml");
            xmldom2.setProperty('SelectionNamespaces', "xmlns:b='http://192.168.0.116/'");
            var result = xmldom.documentElement.selectNodes('b:books/b:book');
            alert(result);
		</script>
	</body>
</html>
